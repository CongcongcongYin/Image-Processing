im=imread('lenna512.bmp');
Qmat=[1,2,2,4,4,4,4,8,8,8,8,8,8,8,8,16;
      2,2,2,4,4,4,4,8,8,8,8,8,8,8,8,16;
      2,2,2,4,4,4,4,8,8,8,8,8,8,8,8,16;
      4,4,4,4,4,4,4,8,8,8,8,8,8,8,8,16;
      4,4,4,4,4,4,4,8,8,8,8,8,8,8,8,16;
      4,4,4,4,4,4,4,8,8,8,8,8,8,8,8,16;
      4,4,4,4,4,4,4,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,16;
      16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16;];
  file_name='1.dat';
N=8;
QP=50;
[rate] = compress_im(im, Qmat, QP, N, file_name);
[imo] = decompress_im(Qmat, QP, N, file_name);
psnr = calculate_psnr(imo, im);